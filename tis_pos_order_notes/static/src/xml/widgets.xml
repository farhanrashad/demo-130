<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    
    <t t-name="button_order_note">
        <div class='control-button'>
            <i class='fa fa-commenting-o'/>
            <span class="label">Order Note</span>
        </div>
    </t>
    <t t-name="button_orderline_note">
        <div class='control-button'>
            <i class='fa fa-comment'/>
            <span class="label">Line Note</span>
        </div>
    </t>


    <t t-name="popup_order_note">
        <div class="modal-dialog">
            <div class="popup order-note">
                <p class="title"><t t-esc=" widget.options.title || 'Confirm ?' " /></p>
                <p class="body"><t t-esc="  widget.options.body || '' "/></p>
                <div class="row" style="padding-bottom: 40px">
                        <textarea class="form-control" style="min-width: 95%;height:10em;"><t t-esc="widget.options.value" class="note-input"/></textarea>
                </div>
                <div class="footer">
                    <div class="button confirm">
                        Add Note 
                    </div>
                    <div class="button cancel">
                        Close
                    </div>
                </div>
            </div>
        </div>
    </t>

    <t t-name="popup_orderline_note">
        <div class="modal-dialog">
            <div class="popup order-line-note">
                <p class="title"><t t-esc=" widget.options.title || 'Confirm ?' " /></p>
                <p class="body"><t t-esc="  widget.options.body || '' "/></p>
                <div class="row" style="padding-bottom: 40px">
                    <textarea class="form-control" style="min-width: 95%;height:10em;"><t t-esc="widget.options.value" class="note-input"/></textarea>
                </div>
                <div class="footer">
                    <div class="button confirm">
                        Add Note 
                    </div>
                    <div class="button cancel">
                        Close
                    </div>
                </div>
            </div>
        </div>        
    </t>

    <t t-extend="OrderReceipt">
        <t t-jquery=".orderlines" t-operation="replace">
    		<div class='orderlines'>
                <t t-foreach='receipt.orderlines' t-as='line'>
                    <t t-set='simple'
                       t-value='(line.discount === 0 and line.unit_name === "Units" and line.quantity === 1 and !discount_to_show and !(line.display_discount_policy == "without_discount" &amp;&amp; line.price != line.price_lst))'/>
                    <t t-if='simple'>
                        <div>
                            <t t-esc='line.product_name_wrapped[0]'/>
                            <span t-esc='widget.format_currency_no_symbol(line.price_display)'
                                  class="price_display pos-receipt-right-align"/>
                        </div>
                        <t t-call="OrderReceiptWrappedProductNameLines"/>
                        <div t-if="line.note">
                            <t t-if="pos.config.print_notes == 1">
			                    <div>
			                        <i class="fa fa-tag">
			                       		<t t-esc="line.note"/>
			                        </i>
			                    </div>
                            </t>
		                </div>
                    </t>
                    <t t-if='!simple'>
                        <div t-esc='line.product_name_wrapped[0]'/>
                        <t t-call="OrderReceiptWrappedProductNameLines"/>
                        <div t-if="line.note">
                            <t t-if="pos.config.print_notes == 1">
			                    <div>
			                        <i class="fa fa-tag">
			                       		<t t-esc="line.note"/>
			                        </i>
			                    </div>
                            </t>
		                </div>
                        <t t-if="line.display_discount_policy == 'without_discount' &amp;&amp; line.price != line.price_lst">
                            <div class="pos-receipt-left-padding">
                                <t t-esc="widget.format_currency_no_symbol(line.price_lst)"/>
                                ->
                                <t t-esc="widget.format_currency_no_symbol(line.price)"/>
                            </div>
                        </t>
                        <t t-elif='line.discount !== 0'>
                            <div class="pos-receipt-left-padding">
                                <t t-if="pos.config.iface_tax_included === 'total'">
                                    <t t-esc="widget.format_currency_no_symbol(line.price_with_tax_before_discount)"/>
                                </t>
                                <t t-else="">
                                    <t t-esc="widget.format_currency_no_symbol(line.price)"/>
                                </t>
                            </div>
                        </t>
                        <t t-if='line.discount !== 0'>
                            <div class="pos-receipt-left-padding">
                                Discount: <t t-esc='line.discount'/>%
                            </div>
                        </t>

                        <div class="pos-receipt-left-padding">
                            <t t-esc="Math.round(line.quantity * Math.pow(10, pos.dp['Product Unit of Measure'])) / Math.pow(10, pos.dp['Product Unit of Measure'])"/>
                            <t t-if='line.unit_name !== "Units"' t-esc='line.unit_name'/>
                            x
                            <t t-esc='widget.format_currency_no_symbol(line.price_display_one)'/>
                            <span class="price_display pos-receipt-right-align">
                                <t t-esc='widget.format_currency_no_symbol(line.price_display)'/>
                            </span>
                        </div>
                    </t>
                </t>
            </div>
        </t>
        <t t-jquery=".pos-receipt-order-data" t-operation="replace">
            <div class="pos-receipt-order-data">
                <div><t t-esc='receipt.name' /></div>
                <div><t t-esc='receipt.date.localestring' /></div>
                <t t-if="receipt.note">
                    <div>
                        <t t-if="pos.config.print_notes == 1">
                            <span>
                                Note:<t t-esc="receipt.note"/>
                            </span>
                        </t>
                    </div>
                </t>
            </div>

        </t>
    </t>   
</templates>
